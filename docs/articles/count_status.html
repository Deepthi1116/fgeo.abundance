<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Review of milestone 1 (issue 41) • forestr</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">forestr</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/forestgeo/forestr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Review of milestone 1 (issue 41)</h1>
                        <h4 class="author">Mauro Lepore</h4>
            
            <h4 class="date">2017-08-29</h4>
          </div>

    
    
<div class="contents">
<div id="measuring-performance" class="section level1">
<h1 class="hasAnchor">
<a href="#measuring-performance" class="anchor"></a>Measuring performance</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(forestr)
<span class="kw">library</span>(dplyr)
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>

x &lt;-<span class="st"> </span>bci12s7mini

<span class="kw">system.time</span>({
  with_dplyr &lt;-<span class="st"> </span><span class="kw"><a href="../reference/count_status.html">count_status</a></span>(<span class="dt">x =</span> x, <span class="dt">.status =</span> <span class="st">"A"</span>, sp)
  with_dplyr &lt;-<span class="st"> </span><span class="kw">arrange</span>(with_dplyr, sp)
})
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;    0.07    0.03    0.11</span>

<span class="kw">system.time</span>({
  <span class="co"># There may be a faster and more elegant way to do this in base</span>
  .split &lt;-<span class="st"> </span><span class="kw">split</span>(x, x$sp)
  applied_1 &lt;-<span class="st"> </span><span class="kw">lapply</span>(.split, ctfs::abundance)
  applied_2 &lt;-<span class="st"> </span><span class="kw">lapply</span>(applied_1, <span class="st">"[["</span>, <span class="st">"abund"</span>)
  
  sp &lt;-<span class="st"> </span><span class="kw">names</span>(applied_2)
  n &lt;-<span class="st"> </span><span class="kw">lapply</span>(applied_2, <span class="st">"[["</span>, <span class="st">"all"</span>)
  n &lt;-<span class="st"> </span><span class="kw">unlist</span>(n)
  with_base &lt;-<span class="st"> </span><span class="kw">data.frame</span>(sp, n, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
  with_base &lt;-<span class="st"> </span>with_base[<span class="kw">order</span>(with_base$sp), ]
})
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;    0.37    0.02    0.41</span>

<span class="kw">head</span>(with_dplyr)
<span class="co">#&gt; # A tibble: 6 x 2</span>
<span class="co">#&gt;       sp     n</span>
<span class="co">#&gt;    &lt;chr&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 acaldi     5</span>
<span class="co">#&gt; 2 aegipa     0</span>
<span class="co">#&gt; 3 alchco     0</span>
<span class="co">#&gt; 4 alibed     2</span>
<span class="co">#&gt; 5 allops     0</span>
<span class="co">#&gt; 6 alsebl    21</span>

<span class="kw">head</span>(with_base)
<span class="co">#&gt;            sp  n</span>
<span class="co">#&gt; acaldi acaldi  5</span>
<span class="co">#&gt; aegipa aegipa  0</span>
<span class="co">#&gt; alchco alchco  0</span>
<span class="co">#&gt; alibed alibed  2</span>
<span class="co">#&gt; allops allops  0</span>
<span class="co">#&gt; alsebl alsebl 21</span>

<span class="kw">all.equal</span>(with_dplyr, with_base)
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
</div>
<div id="meeting-gabriel" class="section level1">
<h1 class="hasAnchor">
<a href="#meeting-gabriel" class="anchor"></a>Meeting Gabriel</h1>
<p>Gabriel proposes to write one single function like thisÑ</p>
<pre><code>abundance(x, group_by = c("sp", "status"), only_alive = TRUE)</code></pre>
<p>The output should look similar to this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/count_status.html">count_status</a></span>(x, <span class="dt">.status =</span> <span class="kw">unique</span>(x$status), sp, status) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(status ==<span class="st"> "A"</span>)
<span class="co">#&gt; # A tibble: 111 x 3</span>
<span class="co">#&gt;       sp status     n</span>
<span class="co">#&gt;    &lt;chr&gt;  &lt;chr&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 apeime      A     2</span>
<span class="co">#&gt; 2 quaras      A     8</span>
<span class="co">#&gt; 3 beilpe      A     6</span>
<span class="co">#&gt; 4 luehse      A     2</span>
<span class="co">#&gt; 5 simaam      A     6</span>
<span class="co">#&gt; 6 alsebl      A    21</span>
<span class="co">#&gt; # ... with 105 more rows</span>

<span class="co"># Same as</span>
<span class="kw">group_by</span>(x, status, sp) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">n =</span> <span class="kw">n</span>()) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(status ==<span class="st"> "A"</span>)
<span class="co">#&gt; # A tibble: 111 x 3</span>
<span class="co">#&gt; # Groups:   status [1]</span>
<span class="co">#&gt;   status     sp     n</span>
<span class="co">#&gt;    &lt;chr&gt;  &lt;chr&gt; &lt;int&gt;</span>
<span class="co">#&gt; 1      A acaldi     5</span>
<span class="co">#&gt; 2      A alibed     2</span>
<span class="co">#&gt; 3      A alsebl    21</span>
<span class="co">#&gt; 4      A anaxpa     3</span>
<span class="co">#&gt; 5      A andiin     1</span>
<span class="co">#&gt; 6      A annoac     5</span>
<span class="co">#&gt; # ... with 105 more rows</span></code></pre></div>
<p>Gabriel proposes getting basal area and biomass simply by changing the function passed to <code>summarize()</code>. He prefers less and longer functions over multiple smaller ones.</p>
<p>Contrary to the idea, notice that there is prenty of advice. The following quotes come from “Code Complete (Developer Best Practices)” by Steve McConnell:</p>
<blockquote>
<p>“One way to improve a system is to increase its modularity—increase the number of well-defined, well-named routines that do one thing and do it well.”</p>
</blockquote>
<p>–<a href="http://a.co/dwa6nBZ" class="uri">http://a.co/dwa6nBZ</a></p>
<blockquote>
<p>“If a routine executes different code depending on the value of an input parameter, consider breaking the routine into separate routines that can be called separately, without passing in that particular input parameter.”</p>
</blockquote>
<p>–<a href="http://a.co/8rXZUPj" class="uri">http://a.co/8rXZUPj</a></p>
<blockquote>
<p>“A parameter list has too many parameters. Well-factored programs tend to have many small, well-defined routines that don’t need large parameter lists. A long parameter list is a warning that the abstraction of the routine interface has not been well thought out. Changes within”</p>
</blockquote>
<p>–<a href="http://a.co/0GmsFwG" class="uri">http://a.co/0GmsFwG</a></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#measuring-performance">Measuring performance</a></li>
      <li><a href="#meeting-gabriel">Meeting Gabriel</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Mauro Lepore, CTFS-ForestGEO.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
